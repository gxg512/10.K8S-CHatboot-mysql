1. openssl genrsa -out george.key 2048
2. openssl req -new -key george.key -out george.csr -subj '/CN=george/O=edit'

#CN ESTE NUMELE USERULUI SI O E NUMELE GRUPULUI

3. cat george.csr | base64 | tr -d "\n"



vi request.csr
cat <<EOF | kubectl apply -f -
apiVersion: certificates.k8s.io/v1
kind: CertificateSigningRequest
metadata:
  name: george
spec:
  request: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0KTUlJQ1pUQ0NBVTBDQVFBd0lERVBNQTBHQTFVRUF3d0daMlZ2Y21kbE1RMHdDd1lEVlFRS0RBUmxaR2wwTUlJQgpJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBNWRDSG9udndyd1pLVDZmSFZJWlRtQVRrCmNJV0ZmeHZZa2JVVHdZdFVOQmxZeFJmNUFMK3JuWFQwVnVHZzhienBCaFVEMkxMdDgzUEtsRnM0YjJ5T0R2OSsKMU9HL3NvenIyVVVZK3hxUjJlM1lyQmRPTjZRUDhzbDZib2swbU4vQURGTkNEclpWU2huODQvdXkyc1MvaEpwYwpyVFd0ZjZRMGM2UmFXRkFvVjl5VVZVbXJzY0E1MmlKWVNWU3Y2TDF0ZU9nMFBoeU03ck53R0NIODRkS2NCZ0MvCjVxS282VjVOUk9MQVNNdWtKY0ZkNjdOVnlvQklVWWVtVkdKQ2EwSmttODFHTFdhcXNranZEZ1RGbTVuQityTzQKNzM4SkY1dmd1aUxoNWFWRFdXRW9CR2s2eS9NT0Y5MVdFVmo3UGlxcnliSXI5emx4QU5RbndsWm9CWVIvc3dJRApBUUFCb0FBd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFEUTRKUmoxNlIraHI0Mkd3aitDcFdTWnAxME5rRjNaCk96S3k4eGtzdEYyd0Fld01Lazd0VWhiTHlCS1lNMkhORXNraHVaYnNsUit4TE5sTmNKOTI3bEJmTDlUV3IzN1cKS2ppbjRZNjdNckp3eGxsMi9iZUloWTF3YVhoK2Zyb3FRVTdiWjZMd0ZRS0h3QitYd3ArZmxheWZhRk9HcnZ3Rgp0czdJVE16ZVRRWDJkQnhBYmNYUkpTNXFuZFVMUW9qeDNIUGZqWXJyZU9rb1g5eWJraVMzbzEvb3JDdTZSaWdrCmlzY0hWQkpkdjJOaGh4MEdvNERHS2ZadGpURVloYVVQNnB4RVpKTmNEYjBSenBVekg3T3p5K1JQOHFIaGpSbCsKWVBDVVVqWll4ZEYvTHhtZ011TjdLYjd2NDlIZ0wxNENidXA0QUduRDQ1QmxxOFhrVSs5MlFMVT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUgUkVRVUVTVC0tLS0tCg==
  signerName: kubernetes.io/kube-apiserver-client
  expirationSeconds: 86400  # one day
  usages:
  - client auth
EOF

4. kubectl certificate approve george

5. kubectl get csr george -o yaml and get the status.certificate

IN my case:
LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURCVENDQWUyZ0F3SUJBZ0lRYnFSakZtR2dvL2g2Q1ZYTE8wSXFwekFOQmdrcWhraUc5dzBCQVFzRkFEQVYKTVJNd0VRWURWUVFERXdwdGFXNXBhM1ZpWlVOQk1CNFhEVEl6TURJd09EQTRNekF3TmxvWERUSXpNREl3T1RBNApNekF3Tmxvd0lERU5NQXNHQTFVRUNoTUVaV1JwZERFUE1BMEdBMVVFQXhNR1oyVnZjbWRsTUlJQklqQU5CZ2txCmhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBNWRDSG9udndyd1pLVDZmSFZJWlRtQVRrY0lXRmZ4dlkKa2JVVHdZdFVOQmxZeFJmNUFMK3JuWFQwVnVHZzhienBCaFVEMkxMdDgzUEtsRnM0YjJ5T0R2OSsxT0cvc296cgoyVVVZK3hxUjJlM1lyQmRPTjZRUDhzbDZib2swbU4vQURGTkNEclpWU2huODQvdXkyc1MvaEpwY3JUV3RmNlEwCmM2UmFXRkFvVjl5VVZVbXJzY0E1MmlKWVNWU3Y2TDF0ZU9nMFBoeU03ck53R0NIODRkS2NCZ0MvNXFLbzZWNU4KUk9MQVNNdWtKY0ZkNjdOVnlvQklVWWVtVkdKQ2EwSmttODFHTFdhcXNranZEZ1RGbTVuQityTzQ3MzhKRjV2Zwp1aUxoNWFWRFdXRW9CR2s2eS9NT0Y5MVdFVmo3UGlxcnliSXI5emx4QU5RbndsWm9CWVIvc3dJREFRQUJvMFl3ClJEQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RBakFNQmdOVkhSTUJBZjhFQWpBQU1COEdBMVVkSXdRWU1CYUEKRkRoQk00MU40NUZMOGFhK1cwSUpnbzlhT2c3MU1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQzZZWWVCajlKWApnNHNUWGxKN01yd2FaNi95bXZVU0Rka0RqRGUrSWYrbnVuOEl1YzVkb1NqVE1XY25GYVNubElveDVRalYyeGNSClJCKzNEUkJEU1VIUGErWVJXeXV6UWtCdDl2NnNUVk14a1IxN1RsZWdia0tYTEtLL0hrMVpndmJ1QXdTLzkrbE8KMXFQTm5pREtlSFB1RkozZDlDRlMxSVQ3NzRZd241T1lkNThQK0dqNjVMb1VtV2s2T0piZ1FmOVQrMnFzR0FWYQpHYkZKcFpseDV5TmgxZFVTaFBNQUJ6SmZ5dEpVa0JvK2tVOE90RzllNTdJR3JMZHl6RmVQdWVybHE3M1JLM0J2CnB5UjRvclI0Sm9NSFllUlVXUnorVmZxZGUrdVBkWXZ1MHE5bkFNeTQyb3FlcEZWY3lKYURVWEJaK3lGMUgzN20KV3lsYUpETXdkbmlBCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K

kubectl get csr/george -o jsonpath='{.status.certificate}' | base64 -d > george.crt

6. Put all of that info to kubeconfig

kubectl --kubeconfig george-config config set-credentials george --client-key=george.key --client-certificate=george.crt --embed-certs=true -> va genera un config local cu informatiile oferite de tine

kubectl --kubeconfig george-config config set-context george --cluster=minikube --user=george

7. kubectl config set-context george --cluster=minikube --user=george
Create context

kubectl config get-contexts
kubectl config use-context george

GO to vim ~/.kube/config AND CHECK IF YOU HAVE STUFF FORM GEORGE-CONFIG ADDED THERE

TRY: ubectl get pods

you should not be allowed because you do not have a cluster role and clusterrolebinding
